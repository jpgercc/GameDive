<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Busca de Jogos</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Busca de Jogos</h1>

        <!-- Botões para escolher o tipo de pesquisa -->
        <div id="opcoes-pesquisa">
            <button onclick="mostrarCampoPesquisa('nome')">Pesquisar por Nome</button>
            <button onclick="mostrarCampoPesquisa('ano')">Pesquisar por Ano</button>
        </div>

        <!-- Campos de entrada escondidos inicialmente -->
        <div id="campo-nome" style="display: none;">
            <label for="nome">Nome do Jogo:</label>
            <input type="text" id="nome" placeholder="Ex: The Witcher 3">
        </div>

        <div id="campo-ano" style="display: none;">
            <label for="ano">Ano de Lançamento:</label>
            <input type="number" id="ano" placeholder="Ex: 2020">
        </div>

        <!-- Botão de busca escondido inicialmente -->
        <button id="botao-buscar" style="display: none;" onclick="buscarJogo()">Buscar Jogo</button>

        <!-- Resultado da busca -->
        <div id="resultado"></div>
    </div>

    <script>
        function mostrarCampoPesquisa(tipo) {
            document.getElementById('campo-nome').style.display = 'none';
            document.getElementById('campo-ano').style.display = 'none';
            document.getElementById('botao-buscar').style.display = 'none';

            if (tipo === 'nome') {
                document.getElementById('campo-nome').style.display = 'block';
            } else if (tipo === 'ano') {
                document.getElementById('campo-ano').style.display = 'block';
            }

            document.getElementById('botao-buscar').style.display = 'block';
        }

        function buscarJogo() {
            const nome = document.getElementById('nome').value || null;
            const ano = document.getElementById('ano').value || null;

            if (!nome && !ano) {
                alert('Por favor, preencha pelo menos um campo de pesquisa.');
                return;
            }

            document.getElementById('resultado').innerHTML = "<p>Carregando...</p>";  // Exibe carregando enquanto espera os resultados

            window.pywebview.api.buscar_jogo(nome, ano).then(jogos => {
                const resultadoDiv = document.getElementById('resultado');
                resultadoDiv.innerHTML = '';

                if (jogos.error) {
                    resultadoDiv.innerHTML = `<p>${jogos.error}</p>`;
                } else {
                    jogos.forEach(jogo => {
                        const imagemUrl = jogo.background_image || 'imagem-default.jpg';  // Caso não tenha imagem, exibe uma padrão

                        resultadoDiv.innerHTML += `
                            <div class="jogo">
                                <h2>${jogo.name}</h2>
                                <img src="${imagemUrl}" alt="Imagem do jogo ${jogo.name}" style="width: 100%; max-width: 400px; margin-bottom: 15px;">
                                <p>Ano de Lançamento: ${jogo.released}</p>
                                <p>Plataformas: ${jogo.platforms.map(p => p.platform.name).join(', ')}</p>
                                <p>Avaliação: ${jogo.rating}</p>
                                <hr>
                            </div>
                        `;
                    });
                }
            });
        }
    </script>
</body>
</html>
